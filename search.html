<!DOCTYPE html>
<meta charset='utf-8' />
<title>BOSS Masterlist Search</title>

<input type="text" id="searchBox">

<select id="gameSelect">
</select>

<button id="searchButton">Search</button>

<script>
var searchTerm;
var masterlists = [
    [ "Oblivion", "https://raw.github.com/boss-developers/boss-oblivion/master/masterlist.yaml" ],
    [ "Skyrim", "http://boss-developers.github.io/boss-skyrim/masterlist.yaml" ],
    [ "Fallout 3", "https://raw.github.com/boss-developers/boss-fallout3/master/masterlist.yaml" ],
    [ "Fallout: New Vegas", "https://raw.github.com/boss-developers/boss-fallout-new-vegas/master/masterlist.yaml" ]
]


var gameSelect = document.getElementById('gameSelect');
var searchButton = document.getElementById('searchButton');
var searchBox = document.getElementById('searchBox');

function onReqLoad() {
    /* Do search here. */
    console.log("Got masterlist");

    console.log("Splitting line-by-line.");

    var lines = this.responseText.split("\n");

    console.log("Starting search.");
    for (var i in lines) {
        if (lines[i].find(searchBox.value)) {
            console.log(lines[i]);
        }
    }
    console.log("Search complete.");
}

function onSearchInit(evt) {

    console.log("Loading masterlist...");

    var mlistReq = new XMLHttpRequest();
    mlistReq.onload = onReqLoad;
    mlistReq.open("get", gameSelect.value, true);
    mlistReq.send();
}

/* Fill the drop-down games box with stuff. */
for (var i=0; i < masterlists.length; ++i) {
    var option = document.createElement('option');
    option.innerText = masterlists[i][0];
    option.setAttribute('value', masterlists[i][1]);
    gameSelect.appendChild(option);
}

document.getElementById("searchButton").addEventListener("click", onSearchInit, false);


</script>
